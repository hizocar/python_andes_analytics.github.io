<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DataFrames</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//images/logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-aboutme" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">AboutMe</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-aboutme">    
        <li class="dropdown-header">AboutMe</li>
        <li>
    <a class="dropdown-item" href="../personal/perfil.html" rel="" target="">
 <span class="dropdown-text">Activities and information about me</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../personal/academica.html" rel="" target="">
 <span class="dropdown-text">Academic Experience</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../personal/laboral.html" rel="" target="">
 <span class="dropdown-text">Data Experience</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Courses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-courses">    
        <li>
    <a class="dropdown-item" href="../machine_learning_egei/classes.html" rel="" target="">
 <span class="dropdown-text">Machine Learning with Business Application UTFSM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../introduction_to_python/classes.html" rel="" target="">
 <span class="dropdown-text">Introduction to Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data_science_ingemat/classes.html" rel="" target="">
 <span class="dropdown-text">Data Science for Math Engineers USACH</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://github.com/hizocar" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-are-dataframes-important" id="toc-why-are-dataframes-important" class="nav-link active" data-scroll-target="#why-are-dataframes-important">Why are DataFrames important?</a></li>
  <li><a href="#applications-in-data-analysis-and-machine-learning" id="toc-applications-in-data-analysis-and-machine-learning" class="nav-link" data-scroll-target="#applications-in-data-analysis-and-machine-learning">Applications in Data Analysis and Machine Learning</a></li>
  <li><a href="#business-example" id="toc-business-example" class="nav-link" data-scroll-target="#business-example">Business Example</a></li>
  <li><a href="#example-1-fictitious-data" id="toc-example-1-fictitious-data" class="nav-link" data-scroll-target="#example-1-fictitious-data">Example 1: Fictitious Data</a>
  <ul class="collapse">
  <li><a href="#creating-a-fictitious-data" id="toc-creating-a-fictitious-data" class="nav-link" data-scroll-target="#creating-a-fictitious-data">Creating a Fictitious Data</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data Exploration</a></li>
  <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering">Feature Engineering</a></li>
  </ul></li>
  <li><a href="#example-2-fortune-data" id="toc-example-2-fortune-data" class="nav-link" data-scroll-target="#example-2-fortune-data">Example 2: Fortune Data</a>
  <ul class="collapse">
  <li><a href="#reading-a-csv-file" id="toc-reading-a-csv-file" class="nav-link" data-scroll-target="#reading-a-csv-file">Reading a CSV File</a></li>
  <li><a href="#descripción-de-las-columnas" id="toc-descripción-de-las-columnas" class="nav-link" data-scroll-target="#descripción-de-las-columnas">Descripción de las Columnas</a></li>
  <li><a href="#data-cleaning-transforming-the-revenue-column" id="toc-data-cleaning-transforming-the-revenue-column" class="nav-link" data-scroll-target="#data-cleaning-transforming-the-revenue-column">Data Cleaning: Transforming the ‘Revenue’ Column</a></li>
  <li><a href="#data-exploration-1" id="toc-data-exploration-1" class="nav-link" data-scroll-target="#data-exploration-1">Data Exploration</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DataFrames</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p align="center">
<img src="images/class2.png" width="50%" height="50%">
</p>
<p>A <strong>DataFrame</strong> is a two-dimensional, size-mutable, and heterogeneous tabular data structure with labeled axes (rows and columns). It is one of the most commonly used data structures in data analysis and machine learning, especially when dealing with structured data.</p>
<section id="why-are-dataframes-important" class="level3">
<h3 class="anchored" data-anchor-id="why-are-dataframes-important">Why are DataFrames important?</h3>
<ul>
<li><strong>Structured Representation</strong>: DataFrames provide a structured representation of data, making it easier to observe and analyze.</li>
<li><strong>Flexibility</strong>: They can hold different types of data (e.g., integer, string, float) in different columns.</li>
<li><strong>Functionality</strong>: Libraries like pandas in Python offer a wide range of functions to manipulate, filter, group, and transform data in DataFrames.</li>
<li><strong>Integration with Machine Learning</strong>: DataFrames are often used as input data structures for machine learning models. They can be easily split into training and testing sets, and their columns can be used as features for models.</li>
</ul>
</section>
<section id="applications-in-data-analysis-and-machine-learning" class="level3">
<h3 class="anchored" data-anchor-id="applications-in-data-analysis-and-machine-learning">Applications in Data Analysis and Machine Learning</h3>
<ol type="1">
<li><strong>Data Cleaning</strong>: Handling missing values, filtering rows or columns, and transforming data.</li>
<li><strong>Data Exploration</strong>: Calculating statistics, visualizing data, and identifying patterns.</li>
<li><strong>Feature Engineering</strong>: Creating new features from existing ones to improve model performance.</li>
<li><strong>Model Training</strong>: Using DataFrames to train machine learning models.</li>
</ol>
</section>
<section id="business-example" class="level3">
<h3 class="anchored" data-anchor-id="business-example">Business Example</h3>
<p>Imagine a retail company that wants to analyze its sales data. The data might include columns like ‘Product ID’, ‘Product Name’, ‘Category’, ‘Price’, ‘Units Sold’, and ‘Date of Sale’. With a DataFrame, the company can easily: - Analyze sales trends over time. - Identify the best-selling products. - Calculate the total revenue for a specific time period. - Group sales data by category or product. - Predict future sales using machine learning models.</p>
</section>
<section id="example-1-fictitious-data" class="level2">
<h2 class="anchored" data-anchor-id="example-1-fictitious-data">Example 1: Fictitious Data</h2>
<section id="creating-a-fictitious-data" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-fictitious-data">Creating a Fictitious Data</h3>
<div class="cell" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a fictitious sales data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Product ID'</span>: np.arange(<span class="dv">1</span>, <span class="dv">101</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Product Name'</span>: [<span class="st">'Product_'</span> <span class="op">+</span> <span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">101</span>)],</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Category'</span>: np.random.choice([<span class="st">'Electronics'</span>, <span class="st">'Clothing'</span>, <span class="st">'Groceries'</span>, <span class="st">'Household'</span>], <span class="dv">100</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Price'</span>: np.random.uniform(<span class="dv">10</span>, <span class="dv">500</span>, <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Units Sold'</span>: np.random.randint(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">100</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Date of Sale'</span>: pd.date_range(start<span class="op">=</span><span class="st">'2022-01-01'</span>, periods<span class="op">=</span><span class="dv">100</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Introducing some missing values</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">'Price'</span>][np.random.randint(<span class="dv">0</span>, <span class="dv">100</span>)] <span class="op">=</span> np.nan</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">'Units Sold'</span>][np.random.randint(<span class="dv">0</span>, <span class="dv">100</span>)] <span class="op">=</span> np.nan</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>sales_df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>sales_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h3>
<div class="cell" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for missing values</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> sales_df.isnull().<span class="bu">sum</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>missing_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Handling missing values by filling with the mean of the column</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sales_df[<span class="st">'Price'</span>].fillna(sales_df[<span class="st">'Price'</span>].mean(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>sales_df[<span class="st">'Units Sold'</span>].fillna(sales_df[<span class="st">'Units Sold'</span>].mean(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifying if there are any missing values left</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>sales_df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-exploration" class="level3">
<h3 class="anchored" data-anchor-id="data-exploration">Data Exploration</h3>
<div class="cell" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting a summary of the data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sales_summary <span class="op">=</span> sales_df.describe()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sales_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the distribution of 'Price'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>sales_df[<span class="st">'Price'</span>].hist(bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Product Prices'</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Price'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Products'</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="feature-engineering" class="level3">
<h3 class="anchored" data-anchor-id="feature-engineering">Feature Engineering</h3>
<div class="cell" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a new feature 'Revenue' which is 'Price' multiplied by 'Units Sold'</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sales_df[<span class="st">'Revenue'</span>] <span class="op">=</span> sales_df[<span class="st">'Price'</span>] <span class="op">*</span> sales_df[<span class="st">'Units Sold'</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a feature 'Month of Sale' extracted from 'Date of Sale'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>sales_df[<span class="st">'Month of Sale'</span>] <span class="op">=</span> sales_df[<span class="st">'Date of Sale'</span>].dt.month</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>sales_df[[<span class="st">'Product Name'</span>, <span class="st">'Price'</span>, <span class="st">'Units Sold'</span>, <span class="st">'Revenue'</span>, <span class="st">'Month of Sale'</span>]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="example-2-fortune-data" class="level2">
<h2 class="anchored" data-anchor-id="example-2-fortune-data">Example 2: Fortune Data</h2>
<section id="reading-a-csv-file" class="level3">
<h3 class="anchored" data-anchor-id="reading-a-csv-file">Reading a CSV File</h3>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:15:53.581731+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:15:53.170911+00:00&quot;}" data-datalink="{&quot;1350a37d-fd1b-44d6-847e-e168b2f5ccf1&quot;:{&quot;applied_filters&quot;:[],&quot;dataframe_info&quot;:{&quot;default_index_used&quot;:true,&quot;orig_num_cols&quot;:7,&quot;orig_num_rows&quot;:5,&quot;orig_size_bytes&quot;:320,&quot;truncated_num_cols&quot;:7,&quot;truncated_num_rows&quot;:5,&quot;truncated_size_bytes&quot;:320,&quot;truncated_string_columns&quot;:[]},&quot;display_id&quot;:&quot;1350a37d-fd1b-44d6-847e-e168b2f5ccf1&quot;,&quot;dx_settings&quot;:{&quot;ALLOW_NOTEABLE_ATTRS&quot;:true,&quot;COLUMN_SAMPLING_METHOD&quot;:&quot;outer&quot;,&quot;DB_LOCATION&quot;:&quot;:memory:&quot;,&quot;DEV_MODE&quot;:false,&quot;DISPLAY_MAX_COLUMNS&quot;:100,&quot;DISPLAY_MAX_ROWS&quot;:50000,&quot;DISPLAY_MODE&quot;:&quot;simple&quot;,&quot;ENABLE_ASSIGNMENT&quot;:true,&quot;ENABLE_DATALINK&quot;:true,&quot;FLATTEN_COLUMN_VALUES&quot;:true,&quot;FLATTEN_INDEX_VALUES&quot;:false,&quot;GENERATE_DEX_METADATA&quot;:false,&quot;HTML_TABLE_SCHEMA&quot;:false,&quot;LOG_LEVEL&quot;:30,&quot;MAX_RENDER_SIZE_BYTES&quot;:104857600,&quot;MAX_STRING_LENGTH&quot;:250,&quot;NUM_PAST_SAMPLES_TRACKED&quot;:3,&quot;RANDOM_STATE&quot;:12648430,&quot;RESET_INDEX_VALUES&quot;:false,&quot;ROW_SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;SAMPLING_FACTOR&quot;:0.1,&quot;SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;STRINGIFY_COLUMN_VALUES&quot;:true,&quot;STRINGIFY_INDEX_VALUES&quot;:false},&quot;sample_history&quot;:[],&quot;sampling_time&quot;:&quot;2023-08-16T19:09:12.994635&quot;,&quot;user_variable_name&quot;:null,&quot;variable_name&quot;:&quot;unk_dataframe_ffa87dd8c613495aa7524e5a4eb9d40b&quot;},&quot;179b44bc-df31-4709-bd60-2d23476263b1&quot;:{&quot;applied_filters&quot;:[],&quot;dataframe_info&quot;:{&quot;default_index_used&quot;:true,&quot;orig_num_cols&quot;:1,&quot;orig_num_rows&quot;:5,&quot;orig_size_bytes&quot;:80,&quot;truncated_num_cols&quot;:1,&quot;truncated_num_rows&quot;:5,&quot;truncated_size_bytes&quot;:80,&quot;truncated_string_columns&quot;:[]},&quot;display_id&quot;:&quot;179b44bc-df31-4709-bd60-2d23476263b1&quot;,&quot;dx_settings&quot;:{&quot;ALLOW_NOTEABLE_ATTRS&quot;:true,&quot;COLUMN_SAMPLING_METHOD&quot;:&quot;outer&quot;,&quot;DB_LOCATION&quot;:&quot;:memory:&quot;,&quot;DEV_MODE&quot;:false,&quot;DISPLAY_MAX_COLUMNS&quot;:100,&quot;DISPLAY_MAX_ROWS&quot;:50000,&quot;DISPLAY_MODE&quot;:&quot;simple&quot;,&quot;ENABLE_ASSIGNMENT&quot;:true,&quot;ENABLE_DATALINK&quot;:true,&quot;FLATTEN_COLUMN_VALUES&quot;:true,&quot;FLATTEN_INDEX_VALUES&quot;:false,&quot;GENERATE_DEX_METADATA&quot;:false,&quot;HTML_TABLE_SCHEMA&quot;:false,&quot;LOG_LEVEL&quot;:30,&quot;MAX_RENDER_SIZE_BYTES&quot;:104857600,&quot;MAX_STRING_LENGTH&quot;:250,&quot;NUM_PAST_SAMPLES_TRACKED&quot;:3,&quot;RANDOM_STATE&quot;:12648430,&quot;RESET_INDEX_VALUES&quot;:false,&quot;ROW_SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;SAMPLING_FACTOR&quot;:0.1,&quot;SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;STRINGIFY_COLUMN_VALUES&quot;:true,&quot;STRINGIFY_INDEX_VALUES&quot;:false},&quot;sample_history&quot;:[],&quot;sampling_time&quot;:&quot;2023-08-16T19:06:22.428184&quot;,&quot;user_variable_name&quot;:null,&quot;variable_name&quot;:&quot;unk_dataframe_dd5583c18d244a8e889a032323f8eb07&quot;},&quot;8d2176d3-b058-4c79-b8f8-83e7861c8870&quot;:{&quot;applied_filters&quot;:[],&quot;dataframe_info&quot;:{&quot;default_index_used&quot;:true,&quot;orig_num_cols&quot;:4,&quot;orig_num_rows&quot;:5,&quot;orig_size_bytes&quot;:200,&quot;truncated_num_cols&quot;:4,&quot;truncated_num_rows&quot;:5,&quot;truncated_size_bytes&quot;:200,&quot;truncated_string_columns&quot;:[]},&quot;display_id&quot;:&quot;8d2176d3-b058-4c79-b8f8-83e7861c8870&quot;,&quot;dx_settings&quot;:{&quot;ALLOW_NOTEABLE_ATTRS&quot;:true,&quot;COLUMN_SAMPLING_METHOD&quot;:&quot;outer&quot;,&quot;DB_LOCATION&quot;:&quot;:memory:&quot;,&quot;DEV_MODE&quot;:false,&quot;DISPLAY_MAX_COLUMNS&quot;:100,&quot;DISPLAY_MAX_ROWS&quot;:50000,&quot;DISPLAY_MODE&quot;:&quot;simple&quot;,&quot;ENABLE_ASSIGNMENT&quot;:true,&quot;ENABLE_DATALINK&quot;:true,&quot;FLATTEN_COLUMN_VALUES&quot;:true,&quot;FLATTEN_INDEX_VALUES&quot;:false,&quot;GENERATE_DEX_METADATA&quot;:false,&quot;HTML_TABLE_SCHEMA&quot;:false,&quot;LOG_LEVEL&quot;:30,&quot;MAX_RENDER_SIZE_BYTES&quot;:104857600,&quot;MAX_STRING_LENGTH&quot;:250,&quot;NUM_PAST_SAMPLES_TRACKED&quot;:3,&quot;RANDOM_STATE&quot;:12648430,&quot;RESET_INDEX_VALUES&quot;:false,&quot;ROW_SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;SAMPLING_FACTOR&quot;:0.1,&quot;SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;STRINGIFY_COLUMN_VALUES&quot;:true,&quot;STRINGIFY_INDEX_VALUES&quot;:false},&quot;sample_history&quot;:[],&quot;sampling_time&quot;:&quot;2023-08-16T19:15:53.424507&quot;,&quot;user_variable_name&quot;:null,&quot;variable_name&quot;:&quot;unk_dataframe_0b42701a41484d0c93a6cdb7ed6f28d4&quot;},&quot;b5b097ed-f13e-4c18-b17a-2e464f82f11f&quot;:{&quot;applied_filters&quot;:[],&quot;dataframe_info&quot;:{&quot;default_index_used&quot;:true,&quot;orig_num_cols&quot;:1,&quot;orig_num_rows&quot;:5,&quot;orig_size_bytes&quot;:80,&quot;truncated_num_cols&quot;:1,&quot;truncated_num_rows&quot;:5,&quot;truncated_size_bytes&quot;:80,&quot;truncated_string_columns&quot;:[]},&quot;display_id&quot;:&quot;b5b097ed-f13e-4c18-b17a-2e464f82f11f&quot;,&quot;dx_settings&quot;:{&quot;ALLOW_NOTEABLE_ATTRS&quot;:true,&quot;COLUMN_SAMPLING_METHOD&quot;:&quot;outer&quot;,&quot;DB_LOCATION&quot;:&quot;:memory:&quot;,&quot;DEV_MODE&quot;:false,&quot;DISPLAY_MAX_COLUMNS&quot;:100,&quot;DISPLAY_MAX_ROWS&quot;:50000,&quot;DISPLAY_MODE&quot;:&quot;simple&quot;,&quot;ENABLE_ASSIGNMENT&quot;:true,&quot;ENABLE_DATALINK&quot;:true,&quot;FLATTEN_COLUMN_VALUES&quot;:true,&quot;FLATTEN_INDEX_VALUES&quot;:false,&quot;GENERATE_DEX_METADATA&quot;:false,&quot;HTML_TABLE_SCHEMA&quot;:false,&quot;LOG_LEVEL&quot;:30,&quot;MAX_RENDER_SIZE_BYTES&quot;:104857600,&quot;MAX_STRING_LENGTH&quot;:250,&quot;NUM_PAST_SAMPLES_TRACKED&quot;:3,&quot;RANDOM_STATE&quot;:12648430,&quot;RESET_INDEX_VALUES&quot;:false,&quot;ROW_SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;SAMPLING_FACTOR&quot;:0.1,&quot;SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;STRINGIFY_COLUMN_VALUES&quot;:true,&quot;STRINGIFY_INDEX_VALUES&quot;:false},&quot;sample_history&quot;:[],&quot;sampling_time&quot;:&quot;2023-08-16T19:09:05.490832&quot;,&quot;user_variable_name&quot;:null,&quot;variable_name&quot;:&quot;unk_dataframe_8211366ab651486a9ab0686801f0b9f3&quot;}}" data-dx="{&quot;fieldMetadata&quot;:{},&quot;simpleTable&quot;:true,&quot;updated&quot;:1692212789216,&quot;views&quot;:[]}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing necessary libraries</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading a sample CSV file related to business and economy</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For this example, I'll use a dataset about Fortune 500 companies</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/hizocar/datasets/main/fortune500.csv'</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>fortune_df <span class="op">=</span> pd.read_csv(url, sep<span class="op">=</span><span class="st">','</span>, on_bad_lines<span class="op">=</span><span class="st">'skip'</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the first few rows of the dataset using .head()</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>fortune_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.dataresource+json</code></pre>
</div>
</div>
</section>
<section id="descripción-de-las-columnas" class="level3">
<h3 class="anchored" data-anchor-id="descripción-de-las-columnas">Descripción de las Columnas</h3>
<ul>
<li><p><strong>Year</strong>: Esta columna representa el año en el que se registraron los datos de la empresa. Es de tipo <code>int64</code>, lo que significa que contiene valores enteros.</p></li>
<li><p><strong>Name</strong>: Esta columna contiene el nombre de la empresa. Es de tipo <code>object</code>, lo que generalmente indica que contiene cadenas de texto.</p></li>
<li><p><strong>Revenue</strong>: Esta columna representa los ingresos de la empresa en millones. Es de tipo <code>float64</code>, lo que indica que contiene valores decimales.</p></li>
</ul>
<p>Cada columna tiene un significado específico y es esencial para el análisis de las empresas Fortune 500 y su rendimiento a lo largo de los años.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:22:16.319367+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:22:16.119331+00:00&quot;}" data-datalink="{&quot;b6c78f76-1bf2-4cb9-91bd-c40fbe32c1e9&quot;:{&quot;applied_filters&quot;:[],&quot;dataframe_info&quot;:{&quot;default_index_used&quot;:false,&quot;orig_num_cols&quot;:1,&quot;orig_num_rows&quot;:4,&quot;orig_size_bytes&quot;:64,&quot;truncated_num_cols&quot;:1,&quot;truncated_num_rows&quot;:4,&quot;truncated_size_bytes&quot;:64,&quot;truncated_string_columns&quot;:[]},&quot;display_id&quot;:&quot;b6c78f76-1bf2-4cb9-91bd-c40fbe32c1e9&quot;,&quot;dx_settings&quot;:{&quot;ALLOW_NOTEABLE_ATTRS&quot;:true,&quot;COLUMN_SAMPLING_METHOD&quot;:&quot;outer&quot;,&quot;DB_LOCATION&quot;:&quot;:memory:&quot;,&quot;DEV_MODE&quot;:false,&quot;DISPLAY_MAX_COLUMNS&quot;:100,&quot;DISPLAY_MAX_ROWS&quot;:50000,&quot;DISPLAY_MODE&quot;:&quot;simple&quot;,&quot;ENABLE_ASSIGNMENT&quot;:true,&quot;ENABLE_DATALINK&quot;:true,&quot;FLATTEN_COLUMN_VALUES&quot;:true,&quot;FLATTEN_INDEX_VALUES&quot;:false,&quot;GENERATE_DEX_METADATA&quot;:false,&quot;HTML_TABLE_SCHEMA&quot;:false,&quot;LOG_LEVEL&quot;:30,&quot;MAX_RENDER_SIZE_BYTES&quot;:104857600,&quot;MAX_STRING_LENGTH&quot;:250,&quot;NUM_PAST_SAMPLES_TRACKED&quot;:3,&quot;RANDOM_STATE&quot;:12648430,&quot;RESET_INDEX_VALUES&quot;:false,&quot;ROW_SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;SAMPLING_FACTOR&quot;:0.1,&quot;SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;STRINGIFY_COLUMN_VALUES&quot;:true,&quot;STRINGIFY_INDEX_VALUES&quot;:false},&quot;sample_history&quot;:[],&quot;sampling_time&quot;:&quot;2023-08-16T19:22:16.163519&quot;,&quot;user_variable_name&quot;:null,&quot;variable_name&quot;:&quot;unk_dataframe_e3715f76c5e947cba3f6d1bba1905887&quot;}}" data-dx="{&quot;fieldMetadata&quot;:{},&quot;simpleTable&quot;:true,&quot;updated&quot;:1692213739047,&quot;views&quot;:[]}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking the data types of each column </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data_types <span class="op">=</span> fortune_df.dtypes</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>data_types</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.dataresource+json</code></pre>
</div>
</div>
</section>
<section id="data-cleaning-transforming-the-revenue-column" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning-transforming-the-revenue-column">Data Cleaning: Transforming the ‘Revenue’ Column</h3>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:29:26.998299+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:29:26.720349+00:00&quot;}" data-datalink="{&quot;f6301bf1-f321-4f2a-a77e-0087da01242d&quot;:{&quot;applied_filters&quot;:[],&quot;dataframe_info&quot;:{&quot;default_index_used&quot;:false,&quot;orig_num_cols&quot;:1,&quot;orig_num_rows&quot;:4,&quot;orig_size_bytes&quot;:64,&quot;truncated_num_cols&quot;:1,&quot;truncated_num_rows&quot;:4,&quot;truncated_size_bytes&quot;:64,&quot;truncated_string_columns&quot;:[]},&quot;display_id&quot;:&quot;f6301bf1-f321-4f2a-a77e-0087da01242d&quot;,&quot;dx_settings&quot;:{&quot;ALLOW_NOTEABLE_ATTRS&quot;:true,&quot;COLUMN_SAMPLING_METHOD&quot;:&quot;outer&quot;,&quot;DB_LOCATION&quot;:&quot;:memory:&quot;,&quot;DEV_MODE&quot;:false,&quot;DISPLAY_MAX_COLUMNS&quot;:100,&quot;DISPLAY_MAX_ROWS&quot;:50000,&quot;DISPLAY_MODE&quot;:&quot;simple&quot;,&quot;ENABLE_ASSIGNMENT&quot;:true,&quot;ENABLE_DATALINK&quot;:true,&quot;FLATTEN_COLUMN_VALUES&quot;:true,&quot;FLATTEN_INDEX_VALUES&quot;:false,&quot;GENERATE_DEX_METADATA&quot;:false,&quot;HTML_TABLE_SCHEMA&quot;:false,&quot;LOG_LEVEL&quot;:30,&quot;MAX_RENDER_SIZE_BYTES&quot;:104857600,&quot;MAX_STRING_LENGTH&quot;:250,&quot;NUM_PAST_SAMPLES_TRACKED&quot;:3,&quot;RANDOM_STATE&quot;:12648430,&quot;RESET_INDEX_VALUES&quot;:false,&quot;ROW_SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;SAMPLING_FACTOR&quot;:0.1,&quot;SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;STRINGIFY_COLUMN_VALUES&quot;:true,&quot;STRINGIFY_INDEX_VALUES&quot;:false},&quot;sample_history&quot;:[],&quot;sampling_time&quot;:&quot;2023-08-16T19:29:26.839847&quot;,&quot;user_variable_name&quot;:null,&quot;variable_name&quot;:&quot;unk_dataframe_02e5010af11048a7889d2cf61be076e9&quot;}}" data-dx="{&quot;fieldMetadata&quot;:{},&quot;simpleTable&quot;:true,&quot;updated&quot;:1692214170613,&quot;views&quot;:[]}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing '-' with 0</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fortune_df[<span class="st">'Revenue'</span>] <span class="op">=</span> fortune_df[<span class="st">'Revenue'</span>].replace(<span class="st">'-'</span>, <span class="st">'0'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing any remaining non-numeric characters and converting to float</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>fortune_df[<span class="st">'Revenue'</span>] <span class="op">=</span> fortune_df[<span class="st">'Revenue'</span>].replace(<span class="st">'[\$,]'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>).astype(<span class="bu">float</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking the data types of each column again</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>data_types_updated <span class="op">=</span> fortune_df.dtypes</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>data_types_updated</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.dataresource+json</code></pre>
</div>
</div>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:30:42.183052+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:30:42.019871+00:00&quot;}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardizing column names to lowercase and replacing spaces with underscores</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fortune_df.columns <span class="op">=</span> fortune_df.columns.<span class="bu">str</span>.lower().<span class="bu">str</span>.replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the updated column names</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>fortune_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['year', 'name', 'revenue', 'rank'], dtype='object')</code></pre>
</div>
</div>
</section>
<section id="data-exploration-1" class="level3">
<h3 class="anchored" data-anchor-id="data-exploration-1">Data Exploration</h3>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:32:45.050524+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:32:44.845488+00:00&quot;}" data-datalink="{&quot;d9ba0064-af08-4b56-8017-c354553bc6f8&quot;:{&quot;applied_filters&quot;:[],&quot;dataframe_info&quot;:{&quot;default_index_used&quot;:false,&quot;orig_num_cols&quot;:1,&quot;orig_num_rows&quot;:4,&quot;orig_size_bytes&quot;:64,&quot;truncated_num_cols&quot;:1,&quot;truncated_num_rows&quot;:4,&quot;truncated_size_bytes&quot;:64,&quot;truncated_string_columns&quot;:[]},&quot;display_id&quot;:&quot;d9ba0064-af08-4b56-8017-c354553bc6f8&quot;,&quot;dx_settings&quot;:{&quot;ALLOW_NOTEABLE_ATTRS&quot;:true,&quot;COLUMN_SAMPLING_METHOD&quot;:&quot;outer&quot;,&quot;DB_LOCATION&quot;:&quot;:memory:&quot;,&quot;DEV_MODE&quot;:false,&quot;DISPLAY_MAX_COLUMNS&quot;:100,&quot;DISPLAY_MAX_ROWS&quot;:50000,&quot;DISPLAY_MODE&quot;:&quot;simple&quot;,&quot;ENABLE_ASSIGNMENT&quot;:true,&quot;ENABLE_DATALINK&quot;:true,&quot;FLATTEN_COLUMN_VALUES&quot;:true,&quot;FLATTEN_INDEX_VALUES&quot;:false,&quot;GENERATE_DEX_METADATA&quot;:false,&quot;HTML_TABLE_SCHEMA&quot;:false,&quot;LOG_LEVEL&quot;:30,&quot;MAX_RENDER_SIZE_BYTES&quot;:104857600,&quot;MAX_STRING_LENGTH&quot;:250,&quot;NUM_PAST_SAMPLES_TRACKED&quot;:3,&quot;RANDOM_STATE&quot;:12648430,&quot;RESET_INDEX_VALUES&quot;:false,&quot;ROW_SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;SAMPLING_FACTOR&quot;:0.1,&quot;SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;STRINGIFY_COLUMN_VALUES&quot;:true,&quot;STRINGIFY_INDEX_VALUES&quot;:false},&quot;sample_history&quot;:[],&quot;sampling_time&quot;:&quot;2023-08-16T19:32:44.894824&quot;,&quot;user_variable_name&quot;:null,&quot;variable_name&quot;:&quot;unk_dataframe_b70a64c3cad1454587351ee753b48b7c&quot;}}" data-dx="{&quot;fieldMetadata&quot;:{},&quot;simpleTable&quot;:true,&quot;updated&quot;:1692214403687,&quot;views&quot;:[]}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for missing values in the dataframe</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> fortune_df.isnull().<span class="bu">sum</span>()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>missing_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.dataresource+json</code></pre>
</div>
</div>
<p>From the initial check for missing values, it appears that there are no missing values in any of the columns of the dataframe. This is great as it means we don’t have to perform any imputation or data filling for this dataset.</p>
<p>Next, let’s use the <code>.describe()</code> method to get a summary of the distribution of the numerical data.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:33:22.129271+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:33:21.902723+00:00&quot;}" data-datalink="{&quot;07f6583c-8e62-42c1-a8aa-6500d1cf701d&quot;:{&quot;applied_filters&quot;:[],&quot;dataframe_info&quot;:{&quot;default_index_used&quot;:false,&quot;orig_num_cols&quot;:3,&quot;orig_num_rows&quot;:8,&quot;orig_size_bytes&quot;:256,&quot;truncated_num_cols&quot;:3,&quot;truncated_num_rows&quot;:8,&quot;truncated_size_bytes&quot;:256,&quot;truncated_string_columns&quot;:[]},&quot;display_id&quot;:&quot;07f6583c-8e62-42c1-a8aa-6500d1cf701d&quot;,&quot;dx_settings&quot;:{&quot;ALLOW_NOTEABLE_ATTRS&quot;:true,&quot;COLUMN_SAMPLING_METHOD&quot;:&quot;outer&quot;,&quot;DB_LOCATION&quot;:&quot;:memory:&quot;,&quot;DEV_MODE&quot;:false,&quot;DISPLAY_MAX_COLUMNS&quot;:100,&quot;DISPLAY_MAX_ROWS&quot;:50000,&quot;DISPLAY_MODE&quot;:&quot;simple&quot;,&quot;ENABLE_ASSIGNMENT&quot;:true,&quot;ENABLE_DATALINK&quot;:true,&quot;FLATTEN_COLUMN_VALUES&quot;:true,&quot;FLATTEN_INDEX_VALUES&quot;:false,&quot;GENERATE_DEX_METADATA&quot;:false,&quot;HTML_TABLE_SCHEMA&quot;:false,&quot;LOG_LEVEL&quot;:30,&quot;MAX_RENDER_SIZE_BYTES&quot;:104857600,&quot;MAX_STRING_LENGTH&quot;:250,&quot;NUM_PAST_SAMPLES_TRACKED&quot;:3,&quot;RANDOM_STATE&quot;:12648430,&quot;RESET_INDEX_VALUES&quot;:false,&quot;ROW_SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;SAMPLING_FACTOR&quot;:0.1,&quot;SAMPLING_METHOD&quot;:&quot;random&quot;,&quot;STRINGIFY_COLUMN_VALUES&quot;:true,&quot;STRINGIFY_INDEX_VALUES&quot;:false},&quot;sample_history&quot;:[],&quot;sampling_time&quot;:&quot;2023-08-16T19:33:21.972670&quot;,&quot;user_variable_name&quot;:&quot;data_summary&quot;,&quot;variable_name&quot;:&quot;data_summary&quot;}}" data-dx="{&quot;fieldMetadata&quot;:{},&quot;simpleTable&quot;:true,&quot;updated&quot;:1692214411049,&quot;views&quot;:[]}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using .describe() to get a summary of the numerical columns</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data_summary <span class="op">=</span> fortune_df.describe()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>data_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.dataresource+json</code></pre>
</div>
</div>
<p>The <code>.describe()</code> method provides a summary of the numerical columns in the dataframe. Here are some insights from the summary:</p>
<ul>
<li><strong>Year</strong>: The data spans from 1955 to 2021.</li>
<li><strong>Revenue</strong>: The average revenue of the companies listed is approximately 8,488.47 million. The minimum revenue is 0 million (which might indicate missing or unreported data for some companies), and the maximum revenue is a staggering 559,151 million. The 25th percentile is 480.45 million, the median (50th percentile) is 2,184.2 million, and the 75th percentile is 7,829.15 million.</li>
<li><strong>Rank</strong>: The rank ranges from 1 to 500, which is expected for a list of the top 500 companies.</li>
</ul>
<p>Next, let’s check the shape of the dataframe to understand its dimensions and then explore the unique values in the non-numerical columns.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:34:14.896100+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:34:14.733096+00:00&quot;}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking the shape of the dataframe</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data_shape <span class="op">=</span> fortune_df.shape</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking unique values in the 'name' column</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>unique_companies <span class="op">=</span> fortune_df[<span class="st">'name'</span>].nunique()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>data_shape, unique_companies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>((33500, 4), 2273)</code></pre>
</div>
</div>
<p>Here are some additional insights from our exploration:</p>
<ul>
<li>The dataframe has <strong>33,500 rows</strong> and <strong>4 columns</strong>. This means we have data for 33,500 entries across the 4 columns.</li>
<li>The <code>name</code> column, which represents the names of the companies, has <strong>2,273 unique values</strong>. This indicates that many companies have appeared on the list multiple times over the years.</li>
</ul>
<p>Given the size of the dataset and the number of unique companies, there’s a wealth of information to explore further, such as trends over time, the distribution of revenues among the top companies, and more.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:38:23.859029+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:38:21.542078+00:00&quot;}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing necessary libraries for data visualization</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting the style for the plots</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">'whitegrid'</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the distribution of the 'year' column</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'year'</span>, data<span class="op">=</span>fortune_df, palette<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Companies by Year'</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="class2_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:38:50.594628+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:38:49.332388+00:00&quot;}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the distribution of the 'revenue' column</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(fortune_df[<span class="st">'revenue'</span>], bins<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'blue'</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Revenue'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Revenue (in millions)'</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="class2_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now, let’s explore the relationships between the numerical variables. One of the best ways to visualize relationships between numerical variables is by using a correlation heatmap. This will allow us to see if there are any strong linear relationships between the variables in our dataset.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:40:03.211522+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:40:02.493849+00:00&quot;}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the correlation matrix</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> fortune_df.corr()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the correlation heatmap</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation Heatmap'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="class2_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>From the correlation heatmap, we can observe the following:</p>
<ul>
<li><strong>Year and Rank</strong>: There’s a negative correlation between the year and the rank. This might indicate that over the years, the ranking criteria or the companies in the list have changed.</li>
<li><strong>Revenue and Rank</strong>: There’s also a negative correlation between revenue and rank. This is expected since a higher revenue would generally mean a higher rank (or a lower rank number) on the Fortune 500 list.</li>
</ul>
<p>It’s important to note that correlation does not imply causation. While these variables might be correlated, it doesn’t mean that one causes the other. The heatmap provides a quick overview of potential relationships that might be worth exploring further.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:43:24.946759+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:43:24.179826+00:00&quot;}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping the data by company and year</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> fortune_df.groupby([<span class="st">'name'</span>, <span class="st">'year'</span>]).mean().reset_index()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the correlation heatmap for the grouped data</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>correlation_matrix_grouped <span class="op">=</span> grouped_data.corr()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix_grouped, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation Heatmap (Grouped Data)'</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="class2_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>After grouping the data by company and year, the correlation heatmap for the grouped data shows similar insights as before. The negative correlation between <code>year</code> and <code>rank</code> and between <code>revenue</code> and <code>rank</code> remains consistent.</p>
<p>Next, let’s visualize the revenue evolution over the years for three companies. We’ll choose ‘Walmart’, ‘Exxon Mobil’, and ‘Apple’ as our sample companies for this analysis.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-08-16T19:44:25.172146+00:00&quot;,&quot;start_time&quot;:&quot;2023-08-16T19:44:24.190048+00:00&quot;}" data-noteable="{&quot;cell_type&quot;:&quot;code&quot;}" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering data for the three chosen companies</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>companies <span class="op">=</span> [<span class="st">'Walmart'</span>, <span class="st">'Exxon Mobil'</span>, <span class="st">'Apple'</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> grouped_data[grouped_data[<span class="st">'name'</span>].isin(companies)]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the revenue evolution over the years for the three companies</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">7</span>))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>filtered_data, x<span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'revenue'</span>, hue<span class="op">=</span><span class="st">'name'</span>, palette<span class="op">=</span><span class="st">'tab10'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Revenue Evolution Over the Years'</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Revenue (in millions)'</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Company'</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="class2_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>